<% layout('/layouts/boilerplate.ejs') %>

<div id="map" style="width: 100%; height: 400px"></div>

<h1>All campgrounds</h1>
<div>
	<a href="campgrounds/new">New Campground</a>
</div>

<% for(let campground of campgrounds) {%>
<div class="card my-3">
	<div class="row p-1">
		<img
			src="<%= campground.images[0].url %>"
			alt=""
			class="col-md-4 img-fluid"
		/>
		<div class="col-md-8">
			<div class="card-body">
				<h5 class="card-title"><%= campground.title %></h5>
				<p class="card-text"><%= campground.description %></p>
				<p class="card-text">
					<small class="text-muted"><%= campground.location %></small>
				</p>
				<a class="btn btn-primary" href="campgrounds/<%= campground._id%>"
					>View <%= campground.title %>
				</a>
			</div>
		</div>
	</div>
</div>

<% } %>

<div class="text-center">
	<a href="/campgrounds?page=<%= pages.current - 1%>" class="btn" style="<%=pages.current==1?"pointer-events: none; color: grey;": ""%>"> < </a>
	<a href="/campgrounds?page=<%= 1 %>" class = "btn <%= pages.current==1?"btn-primary":"btn-secondary"  %>">1</a>
	<%# Previous a %> <% if(pages.current-1>2) { %> ...
	<a href="/campgrounds?page=<%= pages.current-1 %>" class = "btn btn-secondary"><%=pages.current-1%></a>
	<% } else if(pages.current-1 == 2) {%>
	<a href="/campgrounds?page=<%= pages.current-1%>" class = "btn btn-secondary"><%=pages.current-1%></a>
	<% } %> 
	<%# current page %> 
	<% if(pages.current !== 1 && pages.current !==
	pages.total) { %>
	<a href="/campgrounds?page=<%= pages.current %>" class = "btn btn-primary"><%=pages.current%></a>
	<%}%> 
	<%# Next a %>
	<%if(pages.current+1==pages.total-1) { %>
	<a href="/campgrounds?page=<%= pages.current+1 %>" class = "btn btn-secondary"><%=pages.current+1%></a>
	<% } else if(pages.current+1<pages.total-1) {%>
	<a href="/campgrounds?page=<%= pages.current+1 %>" class = "btn btn-secondary"><%=pages.current+1%></a>
	...
	<% } %> 
	<a href="/campgrounds?page=<%= pages.total %>" class = "btn <%= pages.current==pages.total?"btn-primary":"btn-secondary"%>"><%=pages.total%></a>
	<a href="/campgrounds?page=<%= pages.current+1 %>" class="btn" style= "<%=pages.current==pages.total?"pointer-events: none; color: grey;": ""%>" > > </a>
</div>

<script>
	const mapboxToken = "<%=process.env.MAPBOX_TOKEN%>";
	const campgrounds = { features: JSON.stringify(campgrounds) };
</script>

<script src="/scripts/clusterMap.js"></script>
